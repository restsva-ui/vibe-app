<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIBE AI - Voice Clone</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0d1012; color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; padding: 15px; margin: 0; }
        .app { width: 100%; max-width: 380px; background: #161a1d; border-radius: 30px; padding: 24px; border: 1px solid #2d3139; }
        .logo { text-align: center; font-weight: 800; color: #00d2ff; font-size: 24px; margin-bottom: 20px; letter-spacing: 2px; }
        .chars { display: flex; justify-content: space-around; margin-bottom: 20px; }
        .card { width: 80px; text-align: center; cursor: pointer; opacity: 0.4; transition: 0.3s; }
        .card.active { opacity: 1; transform: scale(1.1); }
        .circle { width: 60px; height: 60px; border-radius: 50%; background: #23282e; margin: 0 auto 8px; border: 2px solid #2d3139; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .active#Diplomat .circle { border-color: #00d2ff; box-shadow: 0 0 15px #00d2ff; }
        
        /* –ì–æ–ª–æ—Å–æ–≤–∞ –ø–∞–Ω–µ–ª—å */
        .voice-panel { background: #0b0d0e; border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 1px dashed #2d3139; text-align: center; }
        .rec-btn { background: #ff4b2b; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-size: 14px; margin-top: 10px; }
        .rec-btn.active { animation: pulse 1.5s infinite; }
        
        textarea { width: 100%; background: #000; border: 1px solid #1e2227; color: white; border-radius: 15px; padding: 15px; height: 100px; outline: none; box-sizing: border-box; font-size: 16px; margin-bottom: 15px; }
        #res { padding: 15px; border-radius: 12px; background: #0b0d0e; color: #4ade80; display: none; border: 1px solid #2d3139; margin-bottom: 15px; }
        .btn { width: 100%; padding: 18px; border-radius: 15px; border: none; font-weight: bold; font-size: 16px; cursor: pointer; background: linear-gradient(135deg, #00d2ff, #0080ff); color: white; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>
<div class="app">
    <div class="logo">VIBE PRO</div>
    
    <div class="voice-panel">
        <span style="font-size: 12px; color: #888;">–ö–õ–û–ù–£–í–ê–ù–ù–Ø –ì–û–õ–û–°–£ (PREMIUM)</span><br>
        <button id="recBtn" class="rec-btn" onclick="toggleRec()">üé§ –ó–∞–ø–∏—Å–∞—Ç–∏ –º—ñ–π –≥–æ–ª–æ—Å</button>
        <div id="status" style="font-size: 10px; margin-top: 5px; color: #00d2ff;"></div>
    </div>

    <div class="chars">
        <div class="card active" id="Diplomat" onclick="sel('Diplomat')"><div class="circle">D</div><span>Diplomat</span></div>
        <div class="card" id="Shark" onclick="sel('Shark')"><div class="circle">S</div><span>Shark</span></div>
    </div>

    <textarea id="inp" placeholder="–û–ø–∏—à—ñ—Ç—å —Å–∏—Ç—É–∞—Ü—ñ—é –∞–±–æ –≤—Å—Ç–∞–≤—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
    <div id="res"></div>
    <button id="b-gen" class="btn" onclick="ask()">‚ú® –ì–ï–ù–ï–†–£–í–ê–¢–ò –¢–ê –û–ó–í–£–ß–ò–¢–ò</button>
</div>

<script>
    let isRecording = false;
    let mode = 'Diplomat';
    const tg = window.Telegram.WebApp;
    tg.expand();

    function sel(m) {
        mode = m;
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.getElementById(m).classList.add('active');
    }

    function toggleRec() {
        isRecording = !isRecording;
        const btn = document.getElementById('recBtn');
        const status = document.getElementById('status');
        if(isRecording) {
            btn.innerHTML = "üõë –ó—É–ø–∏–Ω–∏—Ç–∏ –∑–∞–ø–∏—Å";
            btn.classList.add('active');
            status.innerHTML = "–ô–¥–µ –∑–∞–ø–∏—Å –∑—Ä–∞–∑–∫–∞ –≤–∞—à–æ–≥–æ –≥–æ–ª–æ—Å—É...";
        } else {
            btn.innerHTML = "üé§ –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≥–æ–ª–æ—Å";
            btn.classList.remove('active');
            status.innerHTML = "–ó—Ä–∞–∑–æ–∫ –≥–æ–ª–æ—Å—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ! (Pro-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ)";
        }
    }

    async function ask() {
        const text = document.getElementById('inp').value;
        const resDiv = document.getElementById('res');
        const btn = document.getElementById('b-gen');
        if(!text.trim()) return;

        btn.disabled = true;
        resDiv.style.display = "block";
        resDiv.innerHTML = "<i>VIBE –∞–Ω–∞–ª—ñ–∑—É—î —Ç–∞ —Å–∏–Ω—Ç–µ–∑—É—î –≤–∞—à –≥–æ–ª–æ—Å...</i>";

        // –¢—É—Ç –ª–æ–≥—ñ–∫–∞ –∑–∞–ø–∏—Ç—É –¥–æ –®–Ü (Groq)
        try {
            const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer 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'
                },
                body: JSON.stringify({
                    model: "llama-3.3-70b-versatile",
                    messages: [{role: "system", content: "–¢–∏ " + mode + ". –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –∫–æ—Ä–æ—Ç–∫–æ."}, {role: "user", content: text}]
                })
            });
            const data = await response.json();
            const answer = data.choices[0].message.content;
            resDiv.innerHTML = "<b>" + mode + ":</b><br>" + answer;

            // –û–∑–≤—É—á–∫–∞ (–ø–æ–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω–∞, –¥–ª—è —Ç–µ—Å—Ç—É)
            const utterance = new SpeechSynthesisUtterance(answer);
            utterance.lang = 'uk-UA';
            window.speechSynthesis.speak(utterance);

        } catch (e) {
            resDiv.innerHTML = "–ü–æ–º–∏–ª–∫–∞ –∑–≤'—è–∑–∫—É.";
        } finally {
            btn.disabled = false;
        }
    }
</script>
</body>
</html>
